name: Status Update Workflow

on:
  workflow_dispatch:
    inputs:
      progress:
        description: 'Progress percentage (0-100)'
        required: true
        type: string
      phase:
        description: 'Current phase'
        required: true
        type: string
      status:
        description: 'Status description'
        required: true
        type: string

jobs:
  update-status:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Update status data
      run: |
        # Create the status data
        cat > inex-live-data.json << EOF
        {
          "progress": ${{ inputs.progress }},
          "phase": "${{ inputs.phase }}",
          "status": "${{ inputs.status }}",
          "lastUpdated": "${{ github.event.head_commit.timestamp || github.event.head_commit.committer.date || github.event.head_commit.author.date || '2025-08-11T00:00:00Z' }}"
        }
        EOF
        
        # Display the updated content
        echo "Updated inex-live-data.json:"
        cat inex-live-data.json
        
    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add inex-live-data.json
        git commit -m "Update project status: ${{ inputs.phase }} - ${{ inputs.progress }}% - ${{ inputs.status }}"
        git push
