<!doctype html>
<html lang="en" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
<title>INEX Systems Portal ‚Äî Management Dashboard</title>
        <meta name="description" content="INEX Systems & Designs ‚Äî Internal management dashboard for Phase 1: Prototype Polish phase. Project management and status updates." />
<link rel="icon" type="image/svg+xml" href="vite.svg" />
<link rel="alternate icon" type="image/x-icon" href="vite.ico" />
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <!-- Firebase configuration with fallback -->
  <script>
    // Firebase configuration - will try to load from external file, fallback to embedded config
    window.FIREBASE_CONFIG = {
      apiKey: "AIzaSyBW4HaQtl9Xce82dDByp_k0I1wVybgbCFQ",
      authDomain: "inex-a4b30.firebaseapp.com",
      projectId: "inex-a4b30",
      storageBucket: "inex-a4b30.firebasestorage.app",
      messagingSenderId: "111262904587",
      appId: "1:111262904587:web:7368dc9a07c8c44db20e",
      measurementId: "G-CL6M00YQJH"
    };
    
    // Try to load external config if available (for development)
    const script = document.createElement('script');
    script.src = 'firebase-config.js';
    script.onload = function() {
      if (window.FIREBASE_CONFIG_EXTERNAL) {
        window.FIREBASE_CONFIG = window.FIREBASE_CONFIG_EXTERNAL;
        console.log('External Firebase config loaded successfully');
      }
    };
    script.onerror = function() {
      console.log('Using embedded Firebase config (external file not available)');
    };
    document.head.appendChild(script);
  </script>
  <!-- INEX Unified Authentication System -->
  <script src="auth-system.js"></script>
<style>
  :root{
    --inex-charcoal:#191919;
    --maroon:#A62E3F;
    --maroon-700:#7c2330;
    --ink:#111; --muted:#666; --border:#e6e6e6;
    --bg:#f5f6f8; --panel:#ffffff; --panel-ink:#222;
    --accent:#FFB200; --accent-ink:#111;
    --radius:16px; --radius-sm:12px;
    --shadow:0 3px 16px rgba(0,0,0,.08);
  }
  html[data-theme="dark"]{
    --ink:#e8ecf6; --muted:#9fa8bc; --border:rgba(255,255,255,.12);
    --bg:#08090e; --panel:rgba(18,20,28,.65); --panel-ink:#e9edf7;
    --shadow:0 20px 50px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.04);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--panel-ink);
       font:14px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
       letter-spacing:.2px;transition:background-color .25s ease,color .25s ease;}

  /* Topbar */
  .topbar{position:sticky;top:0;z-index:80;display:flex;align-items:center;gap:.75rem;padding:.9rem 1.25rem;background:var(--inex-charcoal);color:#fff;border-bottom:3px solid #2a2a2a}
  html[data-theme="dark"] .topbar{background:linear-gradient(180deg, rgba(8,9,14,.9), rgba(8,9,14,.6));border-bottom:1px solid var(--border);backdrop-filter: blur(10px)}
  .brand{display:flex;align-items:center;gap:.75rem;font-weight:800}
  .brand img{height:36px;width:auto;filter:drop-shadow(0 2px 8px rgba(0,0,0,.35))}
  .brand small{opacity:.8;font-weight:600}
  .spacer{flex:1}
  .toggle{display:inline-flex;align-items:center;gap:.5rem;padding:.45rem .7rem;border-radius:999px;border:1px solid rgba(255,255,255,.25);color:#fff;background:rgba(255,255,255,.06);cursor:pointer;font-weight:800;font-size:12px;text-decoration:none}
  .toggle .dot{width:9px;height:9px;border-radius:50%;background:#FFB200;box-shadow:0 0 10px #ffb20088}
  .pitch-btn{display:inline-flex;align-items:center;gap:.5rem;margin-right:.5rem;padding:.45rem .7rem;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.06);color:#fff;text-decoration:none;font-weight:800;cursor:pointer}

  /* Layout */
  .wrap{display:grid;grid-template-columns:260px minmax(0,1fr);min-height:calc(100vh - 64px)}
  aside{background:#fafafa;border-right:1px solid var(--border);padding:1rem}
  html[data-theme="dark"] aside{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01))}
  .nav h3{margin:.25rem 0 .6rem 0;font-size:12px;text-transform:uppercase;letter-spacing:.12em;color:#888}
  html[data-theme="dark"] .nav h3{color:var(--muted)}
  .nav a{display:flex;align-items:center;gap:.6rem;padding:.6rem .7rem;border-radius:10px;color:#333;text-decoration:none;border:1px solid transparent;transition:.18s ease all}
  .nav a:hover,.nav a:focus-visible{background:#f0f0f0}
  .nav a.active{color:var(--maroon);background:#f8f1f2;font-weight:700;border:1px solid #f0d8dc}
  html[data-theme="dark"] .nav a{color:var(--panel-ink)}
  html[data-theme="dark"] .nav a:hover{background:rgba(255,255,255,.05);border-color:var(--border)}
  html[data-theme="dark"] .nav a.active{background:linear-gradient(180deg, rgba(166,46,63,.28), rgba(166,46,63,.18));border-color:#5c2029;color:#fff;box-shadow:0 8px 26px rgba(166,46,63,.25)}

  main{padding:1.25rem;max-width:1400px;margin-inline:auto}
  .header{display:flex;align-items:baseline;gap:1rem;flex-wrap:wrap;margin:.25rem 0 1rem 0}
  .header h1{margin:0;font-size:24px;color:var(--ink)}
  .muted{color:var(--muted)}
  .cards{display:grid;gap:1rem;grid-template-columns:repeat(12,minmax(0,1fr))}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:var(--shadow);transform:translateZ(0)}
  html[data-theme="dark"] .card{backdrop-filter: blur(10px)}
  .head{padding:.8rem 1rem;background:#f8f8f8;border-bottom:1px solid var(--border);font-weight:800}
  html[data-theme="dark"] .head{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02))}
  .body{padding:1rem}
  .list{margin:0;padding-left:1.1rem}.list li{margin:.3rem 0}
  .pill{display:inline-block;background:#f7f7f7;border:1px solid var(--border);border-radius:999px;padding:.35rem .65rem;font-size:12px}
  html[data-theme="dark"] .pill{background:rgba(255,255,255,.06);border-color:var(--border);color:var(--panel-ink)}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:.8rem 1rem;border-radius:12px;border:1px solid transparent;text-decoration:none;font-weight:800;cursor:pointer;transition:.15s transform ease}
  .btn:hover{transform:translateY(-1px);filter:brightness(.97)}
  .btn.primary{background:var(--maroon);color:#fff;border-color:var(--maroon-700)}
  
  /* Message display styles */
  .message-item {
    padding: 20px !important;
    border: 1px solid var(--border) !important;
    border-radius: 16px !important;
    margin-bottom: 16px !important;
    background: rgba(255,255,255,.04) !important;
    box-shadow: 0 4px 16px rgba(0,0,0,.08) !important;
    transition: all 0.3s ease !important;
    position: relative !important;
    overflow: hidden !important;
  }
  
  .message-item:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 24px rgba(0,0,0,.12) !important;
  }
  
  .message-avatar {
    width: 40px !important;
    height: 40px !important;
    border-radius: 50% !important;
    background: linear-gradient(135deg, var(--accent), var(--maroon)) !important;
    display: grid !important;
    place-items: center !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 16px !important;
    box-shadow: 0 2px 8px rgba(255,178,0,0.3) !important;
  }
  
  .message-content {
    font-size: 14px !important;
    line-height: 1.6 !important;
    color: var(--panel-ink) !important;
    margin-bottom: 16px !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    padding: 16px !important;
    background: rgba(255,255,255,.02) !important;
    border-radius: 12px !important;
    border-left: 4px solid var(--accent) !important;
  }

  /* Message layout helpers (class-based; avoids inline styling conflicts) */
  .message-header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin-bottom:16px}
  .message-header .left{display:flex;align-items:center;gap:12px}
  .message-time{color:var(--muted);font-size:12px;background:rgba(255,255,255,.08);padding:6px 10px;border-radius:8px;font-weight:500;white-space:nowrap}
  .priority-tag{padding:4px 12px;border-radius:20px;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;border:1px solid transparent}
  .priority-urgent{background:rgba(244,67,54,.15);color:#f44336;border-color:rgba(244,67,54,.3)}
  .priority-high{background:rgba(255,152,0,.15);color:#ff9800;border-color:rgba(255,152,0,.3)}
  .priority-low{background:rgba(76,175,80,.15);color:#4caf50;border-color:rgba(76,175,80,.3)}
  .priority-bar{position:absolute;top:0;left:0;right:0;height:4px}
  .priority-bar.urgent{background:linear-gradient(90deg,#f44336,#ff5722)}
  .priority-bar.high{background:linear-gradient(90deg,#ff9800,#ffc107)}
  .priority-bar.low{background:linear-gradient(90deg,#4caf50,#8bc34a)}
  .message-response{margin-top:16px;padding:16px;background:linear-gradient(135deg, rgba(166,46,63,.08), rgba(255,178,0,.08));border:1px solid rgba(166,46,63,.15);border-radius:12px;position:relative}
  .message-response .label{position:absolute;top:-8px;left:16px;background:var(--panel);padding:0 8px;font-size:11px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.5px}
  .message-response .text{font-size:13px;line-height:1.5;color:var(--panel-ink);font-style:italic}
  .message-response .meta{margin-top:8px;font-size:11px;color:var(--muted);display:flex;align-items:center;gap:6px}
  .message-status{display:flex;align-items:center;gap:12px;margin-top:16px;padding-top:16px;border-top:1px solid var(--border)}
  .status-chip{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--muted)}
  .status-dot{width:8px;height:8px;border-radius:50%}
  .status-dot.ok{background:#4caf50}
  .status-dot.warn{background:#ff9800}
  .status-dot.err{background:#f44336}
  
  /* Enhanced form container styling */
  .message-form {
    background: rgba(255, 255, 255, 0.05) !important;
    padding: 24px !important;
    border-radius: 16px !important;
    border: 1px solid rgba(230, 230, 230, 0.3) !important;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1) !important;
  }
  
  .message-form > div {
    margin-bottom: 20px !important;
  }
  
  .message-form > div:last-child {
    margin-bottom: 0 !important;
  }
  .btn.secondary{background:var(--accent);color:var(--accent-ink);border-color:#e6a300}
  .btn.ghost{background:#fff;color:var(--maroon);border-color:#e9c6cc}
  html[data-theme="dark"] .btn.ghost{background:rgba(255,255,255,.06);color:#fff;border-color:var(--border)}
  .table{width:100%;border-collapse:separate;border-spacing:0;border:1px solid var(--border);border-radius:12px;overflow:hidden}
  .table th,.table td{padding:.75rem .9rem;border-bottom:1px solid var(--border);text-align:left}
  .table thead th{background:#191919;color:#FFB200;font-weight:800}
  html[data-theme="dark"] .table thead th{background:#11131a}
  .table tr:nth-child(even) td{background:#fbfbfb}
  html[data-theme="dark"] .table tr:nth-child(even) td{background:rgba(255,255,255,.03)}
  .span-4{grid-column:span 4}.span-6{grid-column:span 6}.span-8{grid-column:span 8}.span-12{grid-column:1/-1}

  .footer{color:#999;font-size:12px;text-align:center;padding:1.2rem}
  html[data-theme="dark"] .footer{color:var(--muted)}

  /* Pitch overlay */
  .overlay{position:fixed;inset:0;z-index:90;display:none;background:rgba(0,0,0,.55)}
  .overlay.show{display:block}
  .pitch{position:relative;max-width:1100px;margin:4vh auto;background:var(--panel);color:var(--panel-ink);
         border:1px solid var(--border);border-radius:18px;box-shadow:0 30px 80px rgba(0,0,0,.45);overflow:hidden;
         max-height:92vh;display:flex;flex-direction:column}
  .pitch-head{display:flex;align-items:center;gap:.9rem;padding:14px 18px;background:linear-gradient(135deg,#A62E3F,#5b1520);color:#fff}
  .pitch-scroll{padding:18px;overflow:auto}
  .pitch-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
  .p-card{background:var(--panel);border:1px solid var(--border);border-radius:14px;overflow:hidden}
  .p-card .p-head{padding:10px 14px;background:#191919;color:#FFB200;font-weight:800}
  html[data-theme="dark"] .p-card .p-head{background:#11131a}
  .p-card .p-body{padding:14px}
  .pitch-close{position:absolute;top:8px;right:8px;background:#fff;border:1px solid #eee;border-radius:10px;padding:8px 10px;font-weight:800;cursor:pointer}
  html[data-theme="dark"] .pitch-close{background:rgba(255,255,255,.08);color:#fff;border-color:var(--border)}

  @media (max-width:1000px){
    .wrap{grid-template-columns:1fr}
    .span-4,.span-6,.span-8{grid-column:1/-1}
    .pitch-grid{grid-template-columns:1fr}
  }
</style>
</head>
<body>
<header class="topbar">
  <div class="brand">
    <img src="inex-logo.png" alt="INEX Systems & Designs Logo" />
    <span>INEX Systems Portal</span>
            <small>¬∑ Management Dashboard</small>
  </div>
  <div class="spacer"></div>
  <button class="pitch-btn" id="openPitch">üìã Project Overview</button>
  <a class="toggle" id="themeToggle" href="#"><span class="dot"></span><span id="themeLabel">1.0 Light</span></a>
</header>

<div class="wrap">
  <aside>
    <nav class="nav">
      <h3>Navigation</h3>
      <a href="#/dashboard" data-route="dashboard" class="active">üè† Dashboard</a>
      <a href="#/projects"  data-route="projects">üìÅ Projects</a>
      <a href="#/planning"  data-route="planning">üìã Planning</a>
      <a href="#/status"    data-route="status">üìä Manage Status</a>
    </nav>
  </aside>

  <main id="view"></main>
</div>

<!-- Project Overview Overlay -->
<div class="overlay" id="pitchOverlay" aria-hidden="true">
  <div class="pitch" role="dialog" aria-modal="true" aria-labelledby="pitchTitle">
    <button class="pitch-close" id="closePitch">‚úï Close</button>
    <div class="pitch-head">
      <img src="inex-logo.png" alt="INEX Logo">
      <h2 id="pitchTitle" style="margin:0;font-size:18px;">INEX Systems Portal ‚Äî Phase 1</h2>
              <span style="opacity:.85;font-weight:700;margin-left:.5rem">Prototype Polish Phase</span>
    </div>
    <div class="pitch-scroll">
      <div class="pitch-grid">
        <div class="p-card">
          <div class="p-head">Phase 1: Prototype Polish</div>
          <div class="p-body">
            <h4 style="margin:.2rem 0 .5rem 0">üéØ Current Focus</h4>
            <ul class="list">
              <li><strong>Working Prototype:</strong> INEX branding integration and basic UI framework</li>
              <li><strong>UI Framework:</strong> Dark/Light theme implementation with INEX colors</li>
              <li><strong>Core Structure:</strong> Dashboard layout and navigation framework</li>
              <li><strong>Documentation:</strong> Project specs and deployment preparation</li>
            </ul>
            <h4 style="margin:1rem 0 .5rem 0">üìã Next Steps</h4>
            <ul class="list">
              <li>Complete INEX branding integration</li>
              <li>Finalize basic UI framework and themes</li>
              <li>Prepare core dashboard structure</li>
              <li>Complete Phase 1 documentation</li>
            </ul>
          </div>
        </div>
        <div class="p-card">
          <div class="p-head">Project Overview</div>
          <div class="p-body">
            <h4 style="margin:.2rem 0 .5rem 0">üèóÔ∏è What We're Building</h4>
            <ul class="list">
              <li><strong>INEX Operations Portal:</strong> Centralized dashboard for INEX team operations</li>
              <li><strong>Project Management:</strong> Tools for tracking installations and client projects</li>
              <li><strong>Inventory System:</strong> Management of ClickShare units and equipment</li>
              <li><strong>Client Portal:</strong> Interface for client access and support</li>
            </ul>
            <div style="margin-top:8px;padding:8px;background:rgba(255,178,0,.1);border:1px solid rgba(255,178,0,.2);border-radius:8px;font-size:12px">
              <strong>üìÖ Timeline:</strong> 4-5 weeks total ‚Ä¢ <strong>üí∞ Investment:</strong> $4,500 + $150/month care plan
            </div>
            <div style="margin-top:8px;padding:8px;background:rgba(166,46,63,.1);border:1px solid rgba(166,46,63,.2);border-radius:8px;font-size:12px">
              <strong>üîÑ Development Phases:</strong><br>
              ‚Ä¢ Phase 1: Prototype Polish (1 week) - Current<br>
              ‚Ä¢ Phase 2: Auth + Connectors (2-3 weeks)<br>
              ‚Ä¢ Phase 3: Client Portal & Reports (1 week)
            </div>
            <div style="margin-top:8px;padding:8px;background:rgba(0,150,136,.1);border:1px solid rgba(0,150,136,.2);border-radius:8px;font-size:12px">
              <strong>üìÖ Updated Timeline:</strong><br>
              ‚Ä¢ Phase 1: Aug 15-22 (Design & Setup)<br>
              ‚Ä¢ Phase 2: Aug 22 - Sep 11 (Development & Testing)<br>
              ‚Ä¢ Phase 3: Sep 11-18 (Deployment & Training)
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px">
              <a class="btn secondary" href="status.html" target="_blank">üìä View Status</a>
              <a class="btn ghost" href="#/dashboard">Back to Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <script>
  /* Views: Phase 1 - Prototype Polish Focus */
  const Views = {
    dashboard: `
      <div class="header"><h1>Welcome to INEX Systems Portal</h1><span class="muted">Phase 1: Prototype Polish ‚Äî INEX-branded operations portal development</span></div>
      <section class="cards">
        <article class="card span-6">
          <div class="head">Current Phase: Prototype Polish</div>
          <div class="body">
            <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
              <div style="width:80px;height:80px;border-radius:50%;background:conic-gradient(#A62E3F var(--progress,5%), #e6e6e6 0);display:grid;place-items:center;border:3px solid #f0f0f0" id="dashboardProgressRing">
                <strong style="font-size:16px" id="dashboardProgressText">5%</strong>
              </div>
              <div>
                <strong>Project Status: Phase 1 - Prototype Polish</strong><br>
                <small class="muted">INEX branding integration and basic UI framework in progress</small>
              </div>
            </div>
            <div style="background:#f8f8f8;border-radius:8px;padding:.8rem;border:1px solid var(--border)">
              <strong>Focus:</strong> Working prototype with INEX branding, basic UI framework (Dark/Light themes), core dashboard structure, and project documentation.
            </div>
            <div style="margin-top:1rem;padding:.8rem;background:rgba(166,46,63,.1);border:1px solid rgba(166,46,63,.2);border-radius:8px">
              <strong>üí° Management Note:</strong> This is your internal dashboard. Use the Status Management section to update progress that Zebediah will see on the public status page.
            </div>
          </div>
        </article>
        <article class="card span-6">
          <div class="head">Quick Actions</div>
          <div class="body">
            <div style="display:grid;gap:.6rem">
              <a class="btn primary" href="#/projects">View Project Timeline</a>
              <a class="btn secondary" href="#/planning">Technical Specs</a>
              <a class="btn primary" href="#/status">Manage Status</a>
              <a class="btn secondary" href="status.html" target="_blank">Client Status Page</a>
            </div>
          </div>
        </article>
        <article class="card span-8">
          <div class="head">Project Timeline Overview</div>
          <div class="body">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
              <div style="border:1px solid var(--border);border-radius:12px;padding:1rem">
                <span class="pill">Phase 1 (Current)</span>
                <ul class="list" style="margin-top:.5rem">
                  <li>Prototype Polish: 1-2 weeks</li>
                  <li>INEX branding integration</li>
                  <li>Basic UI framework</li>
                  <li>ETA: Aug 15-22</li>
                </ul>
              </div>
              <div style="border:1px solid var(--border);border-radius:12px;padding:1rem">
                <span class="pill">Phase 2 & 3</span>
                <ul class="list" style="margin-top:.5rem">
                  <li>Auth + Connectors: 2-4 weeks</li>
                  <li>Client Portal: 2-3 weeks</li>
                  <li>Total: 4-5 weeks</li>
                  <li>Full ETA: Mar 5-19</li>
                </ul>
              </div>
            </div>
          </div>
        </article>
        <article class="card span-4">
          <div class="head">Project Info</div>
          <div class="body">
            <ul class="list">
              <li><strong>Client:</strong> INEX Systems & Designs</li>
              <li><strong>Phase:</strong> 1 - Prototype Polish</li>
              <li><strong>Progress:</strong> 5%</li>
              <li><strong>ETA:</strong> Sep 11-18, 2025</li>
            </ul>
          </div>
        </article>
      </section>
      <p class="footer">INEX Systems Portal ‚Ä¢ Phase 1: Prototype Polish ‚Ä¢ ¬© Cochran Full Stack Solutions</p>
    `,
    projects: `
      <div class="header"><h1>Project Planning</h1><span class="muted">Prototype Polish phase planning and development</span></div>
      <div class="cards">
        <article class="card span-8">
          <div class="head">Project Timeline</div>
          <div class="body">
            <table class="table">
              <thead><tr><th>Phase</th><th>Duration</th><th>Status</th><th>Deliverables</th><th>ETA</th></tr></thead>
              <tbody>
                <tr><td><strong>Phase 1:</strong> Prototype Polish</td><td>1 week</td><td><span class="pill">In Progress</span></td><td>Working prototype, basic UI</td><td>Aug 15-22</td></tr>
                <tr><td><strong>Phase 2:</strong> Auth + Connectors</td><td>2-3 weeks</td><td><span class="pill">Planned</span></td><td>Authentication, data integration</td><td>Aug 22 - Sep 11</td></tr>
                <tr><td><strong>Phase 3:</strong> Client Portal & Reports</td><td>1 week</td><td><span class="pill">Planned</span></td><td>Full deployment, training</td><td>Sep 11-18</td></tr>
              </tbody>
            </table>
            <div style="margin-top:1rem;padding:.8rem;background:rgba(166,46,63,.1);border:1px solid rgba(166,46,63,.2);border-radius:8px">
              <strong>üìÖ Total Timeline:</strong> 4-5 weeks from signed agreement ‚Ä¢ <strong>üí∞ Investment:</strong> $4,500 + $150/month care plan
            </div>
          </div>
        </article>
        <article class="card span-4">
          <div class="head">Phase 1 Deliverables</div>
          <div class="body">
            <ul class="list">
              <li>Working prototype with INEX branding</li>
              <li>Basic UI framework (Dark/Light themes)</li>
              <li>Core dashboard structure</li>
              <li>Project documentation</li>
              <li>Deployment preparation</li>
            </ul>
          </div>
        </article>
      </div>
    `,
    planning: `
      <div class="header"><h1>Planning Documents</h1><span class="muted">Project planning and technical specifications</span></div>
      <div class="cards">
        <article class="card span-6">
          <div class="head">Technical Architecture</div>
          <div class="body">
            <h4>Portal Structure:</h4>
            <ul class="list">
              <li><strong>Dashboard:</strong> Operations overview and KPIs</li>
              <li><strong>Projects:</strong> Job management and tracking</li>
              <li><strong>Jobs/Dispatch:</strong> Assignment and workflow</li>
              <li><strong>Inventory:</strong> ClickShare units and parts</li>
              <li><strong>RMA/Warranties:</strong> Service tracking</li>
              <li><strong>SLAs/Reports:</strong> Performance metrics</li>
              <li><strong>Knowledge:</strong> Documentation hub</li>
              <li><strong>Clients:</strong> Client management</li>
              <li><strong>Careers:</strong> Job listings</li>
              <li><strong>Settings:</strong> System configuration</li>
            </ul>
            <div style="margin-top:1rem">
              <a class="btn primary" href="#">View Technical Specs</a>
            </div>
          </div>
        </article>
        <article class="card span-6">
          <div class="head">Implementation Plan</div>
          <div class="body">
            <h4>Development Phases:</h4>
            <ul class="list">
              <li><strong>Phase 1 (1-2 weeks):</strong> Prototype polish and basic UI</li>
              <li><strong>Phase 2 (2-4 weeks):</strong> Authentication and data connectors</li>
              <li><strong>Phase 3 (2-3 weeks):</strong> Client portal and reporting</li>
            </ul>
            <div style="margin-top:1rem">
              <a class="btn secondary" href="#">Project Roadmap</a>
            </div>
          </div>
        </article>
      </div>
    `,
        status: `
      <div class="header"><h1>Status Management</h1><span class="muted">Update project status and progress for client visibility</span></div>
      
      <!-- Current Status Overview Section -->
      <div class="cards">
        <article class="card span-8">
          <div class="head">Current Status Overview</div>
          <div class="body">
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1rem">
              <div style="text-align:center;padding:1rem;border:1px solid var(--border);border-radius:12px;background:var(--panel)">
                <div style="font-size:24px;font-weight:900;color:var(--maroon)" id="progressDisplay">5%</div>
                <div style="font-size:12px;color:var(--muted)">Overall Progress</div>
              </div>
              <div style="text-align:center;padding:1rem;border:1px solid var(--border);border-radius:12px;background:var(--panel)">
                <div style="font-size:24px;font-weight:900;color:var(--accent)" id="tasksDisplay">1/3</div>
                <div style="font-size:12px;color:var(--muted)">Phases Complete</div>
              </div>
              <div style="text-align:center;padding:1rem;border:1px solid var(--border);border-radius:12px;background:var(--panel)">
                <div style="font-size:24px;font-weight:900;color:var(--muted)" id="phaseDisplay">Discovery</div>
                <div style="font-size:12px;color:var(--muted)">Current Phase</div>
              </div>
              <div style="text-align:center;padding:1rem;border:1px solid var(--border);border-radius:12px;background:var(--panel)">
                <div style="font-size:24px;font-weight:900;color:var(--muted)" id="etaDisplay">Aug 22</div>
                <div style="font-size:12px;color:var(--muted)">Phase 1 End</div>
              </div>
            </div>
            
            <div style="background:#f8f8f8;border-radius:8px;padding:1rem;border:1px solid var(--border);margin-bottom:1rem">
              <strong>Current Status:</strong> <span id="statusText">Project initiated - gathering requirements.</span>
            </div>
            
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
              <button class="btn primary" onclick="updateStatus()">Update Status</button>
              <a class="btn secondary" href="status.html" target="_blank">View Public Status</a>
            </div>
          </div>
        </article>
        
        <article class="card span-4">
          <div class="head">Quick Actions</div>
          <div class="body">
            <div style="display:grid;gap:.6rem">
              <button class="btn secondary" onclick="incrementProgress()">+10% Progress</button>
              <button class="btn secondary" onclick="nextPhase()">Next Phase</button>
              <button class="btn secondary" onclick="addUpdate()">Add Update</button>
            </div>
          </div>
        </article>
      </div>

      <!-- Live Deployment Controls Section -->
      <div class="cards" style="margin-top:1rem">
        <article class="card span-8">
          <div class="head">üöÄ Live Deployment Controls</div>
          <div class="body">
            <p style="margin:0 0 1rem 0;color:var(--muted);font-size:14px">
              These buttons will automatically update both local status AND deploy to Zebediah's status page via GitHub API:
            </p>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
              <button class="btn primary" onclick="deployStatusUpdate()">üöÄ Deploy Status Update</button>
              <button class="btn secondary" onclick="deployPhaseChange()">üîÑ Deploy Phase Change</button>
            </div>
          </div>
        </article>
      </div>

      <!-- Automatic Sync Section -->
      <div class="cards" style="margin-top:1rem">
        <article class="card span-8">
          <div class="head">üîÑ Automatic Sync</div>
          <div class="body">
            <p style="margin:0 0 1rem 0;color:var(--muted);font-size:14px">
              The system now automatically syncs data between the dashboard and status page via GitHub API:
            </p>
            <div>
              <button class="btn secondary" onclick="syncWithStatusPage()">üîÑ Manual Sync (Backup)</button>
            </div>
          </div>
        </article>
      </div>

      <!-- Communication Section -->
      <div class="cards" style="margin-top:1rem">
        <!-- Firebase Authentication Banner -->
        <article class="card span-8">
          <div class="head">üîê Authentication</div>
          <div class="body">
            <div id="authBanner" style="text-align:center;margin-bottom:20px;padding:1rem;background:linear-gradient(135deg, rgba(166,46,63,.1), rgba(255,178,0,.1));border:1px solid rgba(166,46,63,.2);border-radius:12px;display:none">
              <strong>üîê Authentication Required</strong><br>
              <small>Please sign in to send messages and track your communications with the development team.</small>
              <div style="margin-top:12px;display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
                <input id="authEmail" type="email" placeholder="Your email" style="padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--panel);color:var(--panel-ink);font-size:14px;min-width:200px">
                <input id="authPassword" type="password" placeholder="Password" style="padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--panel);color:var(--panel-ink);font-size:14px;min-width:150px">
                <button id="authLoginBtn" class="btn primary" style="padding:8px 16px;font-size:14px">üîê Sign In</button>
                <button id="authSignupBtn" class="btn secondary" style="padding:8px 16px;font-size:14px">üìù Create Account</button>
              </div>
              <div id="authStatus" style="margin-top:8px;font-size:12px;color:var(--muted)"></div>
            </div>
            
            <!-- User Info Display (shown when logged in) -->
            <div id="userInfo" style="display:none;margin-bottom:16px;padding:12px;background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.2);border-radius:8px;font-size:12px">
              <div id="userInfoContent"></div>
              <button id="signOutBtn" class="btn secondary" style="display:inline-block;padding:8px 16px;font-size:12px;margin-top:8px;background:rgba(220,38,38,0.1);color:#dc2626;border:1px solid rgba(220,38,38,0.3);border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.2s ease;width:auto;height:auto;opacity:1;visibility:visible;" onmouseover="this.style.background='rgba(220,38,38,0.2)'" onmouseout="this.style.background='rgba(220,38,38,0.1)'">üö™ Sign Out</button>
            </div>
            
            <p style="margin:0 0 16px 0;font-size:14px;color:var(--muted);line-height:1.5">
              Send a message to the development team. Your message will be visible to both you and the developers.
            </p>
            
            <form id="messageForm" style="display:grid;gap:16px">
              <div style="display:grid;gap:8px">
                <label for="messageName" style="font-size:12px;font-weight:600;color:var(--panel-ink);text-transform:uppercase;letter-spacing:0.5px">YOUR NAME</label>
                <input type="text" id="messageName" placeholder="Anonymous" style="padding:12px 16px;border:2px solid var(--border);border-radius:12px;background:var(--panel);color:var(--panel-ink);font-size:14px;transition:all 0.2s ease;outline:none" onfocus="this.style.borderColor='var(--accent)'" onblur="this.style.borderColor='var(--border)'">
              </div>
              
              <div style="display:grid;gap:8px">
                <label for="messageText" style="font-size:12px;font-weight:600;color:var(--panel-ink);text-transform:uppercase;letter-spacing:0.5px">MESSAGE</label>
                <textarea id="messageText" placeholder="Type your message here..." rows="4" style="padding:12px 16px;border:2px solid var(--border);border-radius:12px;background:var(--panel);color:var(--panel-ink);font-size:14px;resize:vertical;transition:all 0.2s ease;outline:none;line-height:1.5" onfocus="this.style.borderColor='var(--accent)'" onblur="this.style.borderColor='var(--border)'"></textarea>
              </div>
              
              <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0">
                <small style="color:var(--muted);font-size:12px;font-weight:500" id="charCount">0 characters</small>
                <button type="submit" class="btn primary" style="padding:12px 24px;font-size:14px;font-weight:700;border-radius:12px;box-shadow:0 4px 12px rgba(166,46,63,0.3);transition:all 0.2s ease" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(166,46,63,0.4)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 4px 12px rgba(166,46,63,0.3)'">üì§ Send Message</button>
              </div>
            </form>
            
            <div style="border-top:2px solid var(--border);padding-top:20px;margin-top:20px">
              <h4 style="margin:0 0 16px 0;font-size:16px;color:var(--accent);font-weight:700;display:flex;align-items:center;gap:8px">
                <span>üì®</span>
                <span>Recent Messages</span>
              </h4>
              <div id="messagesList" style="max-height:400px;overflow-y:auto;padding-right:8px">
                <div style="text-align:center;padding:40px 20px;color:var(--muted);font-size:14px;background:rgba(255,255,255,0.02);border-radius:12px;border:2px dashed var(--border)">
                  <div style="font-size:24px;margin-bottom:8px">üí¨</div>
                  <div style="font-weight:600;margin-bottom:4px">No messages yet</div>
                  <div>Send the first message to get started!</div>
                </div>
              </div>
            </div>
            
            <!-- Reply Form Container -->
            <div id="replyFormContainer" style="display:none;margin-top:20px;padding:20px;background:rgba(255,178,0,.05);border:1px solid rgba(255,178,0,.2);border-radius:12px;">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
                <h5 style="margin:0;color:var(--accent);font-size:14px;font-weight:600">üí¨ Reply to: <span id="replyToName"></span></h5>
                <button class="btn secondary" style="padding:4px 8px;font-size:11px" onclick="hideReplyForm()">‚úï Close</button>
              </div>
              <div style="display:grid;gap:12px">
                <div>
                  <label style="font-size:12px;font-weight:600;color:var(--panel-ink);text-transform:uppercase;letter-spacing:0.5px">YOUR RESPONSE</label>
                  <textarea id="replyText" placeholder="Type your response here..." rows="3" style="width:100%;padding:12px 16px;border:2px solid var(--border);border-radius:12px;background:var(--panel);color:var(--panel-ink);font-size:14px;resize:vertical;transition:all 0.2s ease;outline:none;line-height:1.5" onfocus="this.style.borderColor='var(--accent)'" onblur="this.style.borderColor='var(--border)'"></textarea>
                </div>
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <small style="color:var(--muted);font-size:12px" id="replyCharCount">0 characters</small>
                  <button class="btn primary" style="padding:8px 16px;font-size:13px;font-weight:600" onclick="submitReply()">üì§ Send Response</button>
                </div>
              </div>
            </div>
          </div>
        </article>

        <article class="card span-4">
          <div class="head">Message Actions</div>
          <div class="body">
            <div style="display:grid;gap:.6rem">
              <button class="btn secondary" onclick="markMessageRead()">Mark as Read</button>
              <button class="btn secondary" onclick="clearMessages()">Clear All</button>
              <button class="btn primary" onclick="refreshMessages()">üîÑ Refresh</button>
              <button class="btn primary" onclick="syncMessagesToGitHub()" style="background: var(--accent); color: var(--accent-ink);">üöÄ Sync Messages</button>
            </div>
            
            <div style="margin-top:1rem;padding:.8rem;background:rgba(0,150,136,.1);border:1px solid rgba(0,150,136,.2);border-radius:8px;font-size:12px;">
              <div style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
                <div style="font-size:16px;flex-shrink:0">üöÄ</div>
                <strong style="font-size:12px;color:var(--panel-ink);">GitHub Integration</strong>
              </div>
              <p style="font-size:11px;color:var(--muted);line-height:1.3;margin:0;">Messages are automatically saved and visible immediately.</p>
            </div>
          </div>
        </article>
      </div>
    `
  };

  const view = document.getElementById('view');
  const links = Array.from(document.querySelectorAll('.nav a'));
  function setActive(route){ links.forEach(a => a.classList.toggle('active', a.dataset.route === route)); }

  function render(){
    const route = location.hash.replace('#/','') || 'dashboard';
    console.log('üîÑ Rendering route:', route);
    setActive(route);
    view.innerHTML = Views[route] || Views.dashboard;
    
    // After rendering, initialize status, update displays, and initialize message form
    setTimeout(async () => {
      console.log('‚è≥ Post-render initialization starting...');
      await initializeStatus();
      updateAllStatusDisplays();
      
      // Initialize message form after view is rendered
      if (route === 'status') {
        console.log('üìù Initializing message form for status view...');
        initializeMessageForm();
        
        // Also load messages for the status view
        console.log('üì® Loading messages for status view...');
        loadDevMessages();
      }
    }, 50);
  }
  window.addEventListener('hashchange', render);
  window.addEventListener('load', render);

  /* Theme toggle + persistence */
  const root = document.documentElement;
  const btn = document.getElementById('themeToggle');
  const label = document.getElementById('themeLabel');
  const saved = localStorage.getItem('inex-theme');
  if(saved){ root.setAttribute('data-theme', saved); label.textContent = saved === 'dark' ? '1.0 Light' : '2.0 Dark'; }
  btn.addEventListener('click', (e)=>{
    e.preventDefault();
    const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', next);
    localStorage.setItem('inex-theme', next);
    label.textContent = next === 'dark' ? '1.0 Light' : '2.0 Dark';
  });

  /* Project overview overlay controls */
  const overlay = document.getElementById('pitchOverlay');
  const openPitch = document.getElementById('openPitch');
  const closePitch = document.getElementById('closePitch');
  function openOverlay(){ overlay.classList.add('show'); overlay.setAttribute('aria-hidden','false'); }
  function closeOverlay(){ overlay.classList.remove('show'); overlay.setAttribute('aria-hidden','true'); }
  openPitch.addEventListener('click', openOverlay);
  closePitch.addEventListener('click', closeOverlay);
  overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeOverlay(); });
  window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && overlay.classList.contains('show')) closeOverlay(); });

  // Determine API base for both messages and status updates
  const isDev = window.location.hostname === 'localhost' || 
                window.location.hostname === '127.0.0.1' ||
                window.location.port !== '' ||
                window.location.protocol === 'file:';
  
  // API endpoints for automatic GitHub integration
  const API_BASE = isDev ? 'http://localhost:3000' : 'https://inex.cochranfilms.com';
  const API_STATUS_UPDATE = `${API_BASE}/api/status-update`;
  const API_MESSAGES = `${API_BASE}/api/messages`;
  
  // For live site, we'll use GitHub integration instead of API calls
  const isLiveSite = !isDev && window.location.hostname === 'inex.cochranfilms.com';

  // Debug logging
  console.log('üîç API Configuration Debug (index.html v1.1):');
  console.log('  Hostname:', window.location.hostname);
  console.log('  Port:', window.location.port);
  console.log('  Protocol:', window.location.protocol);
  console.log('  Origin:', window.location.origin);
  console.log('  isDev:', isDev);
  console.log('  API_BASE:', API_BASE);
  console.log('  API_STATUS_UPDATE:', API_STATUS_UPDATE);
  console.log('  API_MESSAGES:', API_MESSAGES);
  console.log('  Build timestamp:', new Date().toISOString());

  // Centralized Status Management System - JSON ONLY
  let currentStatus = {
    progress: 5,
    phase: 'Phase 1',
    phaseName: 'Prototype Polish',
    status: 'Phase 1 (Prototype Polish) in progress. Working on INEX branding integration and basic UI framework. On track for Aug 22 completion.',
    lastUpdated: new Date().toISOString(),
    eta: 'Sep 11-18, 2025',
    scope: 'Scope v1.0',
    owner: 'Cochran Full Stack Solutions',
    client: 'INEX'
  };

  // Initialize status from JSON only; do not write on load
  async function initializeStatus() {
    try {
      console.log('üîÑ Initializing status from JSON...');
      await loadFromFallbackJSON();
    } catch (error) {
      console.log('‚ö†Ô∏è Error in initializeStatus, using defaults:', error.message);
    }
    
    // Update all displays
    console.log('üîÑ Calling updateAllStatusDisplays...');
    updateAllStatusDisplays();
  }

  // Fallback function to load from JSON file
  async function loadFromFallbackJSON() {
    try {
      console.log('üìÑ Loading from fallback JSON...');
      const response = await fetch('inex-live-data.json');
      if (response.ok) {
        const liveData = await response.json();
        console.log('üìÑ Loaded fallback data:', liveData);
        
        // Load all available parameters from JSON
        currentStatus.progress = liveData.progress || 5;
        currentStatus.phase = liveData.phase || 'Phase 1';
        currentStatus.phaseName = liveData.phaseName || 'Prototype Polish';
        currentStatus.status = liveData.status || 'Phase 1 (Prototype Polish) in progress. Working on INEX branding integration and basic UI framework. On track for Aug 22 completion.';
        currentStatus.lastUpdated = liveData.lastUpdated || new Date().toISOString();
        currentStatus.eta = liveData.eta || 'Sep 11-18, 2025';
        currentStatus.scope = liveData.scope || 'Scope v1.0';
        currentStatus.owner = liveData.owner || 'Cochran Full Stack Solutions';
        currentStatus.client = liveData.client || 'INEX';
        
        console.log('‚úÖ Status loaded from fallback JSON:', currentStatus);
      } else {
        console.log('‚ö†Ô∏è Could not load fallback data, using defaults');
      }
    } catch (error) {
      console.log('‚ö†Ô∏è Error loading fallback data, using defaults:', error.message);
    }
  }

  // Update all status displays across all views
  function updateAllStatusDisplays() {
    console.log('üîÑ Updating status displays with:', currentStatus);
    
    // Check if we're on the status page
    const isStatusPage = location.hash.includes('status') || location.hash === '';
    console.log('üîç Current route:', location.hash, 'Is status page:', isStatusPage);
    
    // Update progress displays
    const progressElements = document.querySelectorAll('#progressDisplay, #dashboardProgressRing, #statusProgress');
    console.log('üîç Found progress elements:', progressElements.length, progressElements);
    progressElements.forEach(el => {
      if (el.id === 'dashboardProgressRing') {
        el.style.setProperty('--progress', currentStatus.progress + '%');
      } else {
        el.textContent = currentStatus.progress + '%';
      }
    });

    // Update phase displays
    const phaseElements = document.querySelectorAll('#phaseDisplay');
    console.log('üîç Found phase elements:', phaseElements.length, phaseElements);
    phaseElements.forEach(el => {
      el.textContent = currentStatus.phase;
      console.log('‚úÖ Updated phase display:', el.id, 'to', currentStatus.phase);
    });

    // Update status text
    const statusElements = document.querySelectorAll('#statusText');
    console.log('üîç Found status text elements:', statusElements.length, statusElements);
    statusElements.forEach(el => {
      el.textContent = currentStatus.status;
      console.log('‚úÖ Updated status text:', el.id, 'to', currentStatus.status);
    });

    // Update dashboard progress ring
    const progressRing = document.getElementById('dashboardProgressRing');
    const progressText = document.getElementById('dashboardProgressText');
    if (progressRing && progressText) {
      progressRing.style.setProperty('--progress', currentStatus.progress + '%');
      progressText.textContent = currentStatus.progress + '%';
    }
    
    console.log('‚úÖ All status displays updated');
  }

  // Save status to JSON via API when explicitly invoked
  async function saveStatus() {
    try {
      // Update via API to JSON files with all available parameters
      const response = await fetch(API_STATUS_UPDATE, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          progress: currentStatus.progress,
          phase: currentStatus.phase,
          status: currentStatus.status,
          phaseName: currentStatus.phaseName,
          eta: currentStatus.eta,
          scope: currentStatus.scope,
          owner: currentStatus.owner,
          client: currentStatus.client
        })
      });

      if (response.ok) {
        console.log('‚úÖ Status saved to JSON via API');
        updateAllStatusDisplays();
      } else {
        console.error('‚ùå Failed to save status to JSON');
      }
    } catch (error) {
      console.error('‚ùå Error saving status:', error);
    }
  }

  // Status Update Functions - Now work from any view
  function updateStatus() {
    const newProgress = prompt('Enter new progress percentage (0-100):', currentStatus.progress);
    if (newProgress !== null && !isNaN(newProgress)) {
      currentStatus.progress = Math.max(0, Math.min(100, parseInt(newProgress)));
      
      const newStatus = prompt('Enter new status description:', currentStatus.status);
      if (newStatus !== null) {
        currentStatus.status = newStatus;
      }
      
      currentStatus.lastUpdated = new Date().toISOString();
      saveStatus();
    }
  }

  function incrementProgress() {
    currentStatus.progress = Math.min(100, currentStatus.progress + 10);
    currentStatus.lastUpdated = new Date().toISOString();
    saveStatus();
  }

  function nextPhase() {
    const phases = ['Phase 1', 'Phase 2', 'Phase 3'];
    const phaseNames = ['Prototype Polish', 'Auth + Connectors', 'Client Portal & Reports'];
    const currentIndex = phases.indexOf(currentStatus.phase);
    
    if (currentIndex < phases.length - 1) {
      currentStatus.phase = phases[currentIndex + 1];
      currentStatus.phaseName = phaseNames[currentIndex + 1];
      currentStatus.status = `Phase transition to ${currentStatus.phase} - ${currentStatus.progress}% complete`;
      currentStatus.lastUpdated = new Date().toISOString();
      saveStatus();
    }
  }

  function addUpdate() {
    const date = prompt('Enter date (e.g., Dec 18):', 'Dec 18');
    if (date !== null) {
      const update = prompt('Enter update description:', '');
      if (update !== null) {
        const status = prompt('Enter status (e.g., In Progress, Complete, Planned):', 'In Progress');
        if (status !== null) {
          // Note: Updates are now managed through the JSON system
          alert('Update functionality is now managed through the JSON system. Use the status update buttons above to make changes.');
        }
      }
    }
  }

  // Live Deployment Functions - Now work from any view
  async function deployStatusUpdate() {
    try {
      console.log('Deploying status update:', currentStatus);
      console.log('üîç Using automatic API for status update');
      console.log('üîç Request payload:', { 
        progress: currentStatus.progress, 
        phase: currentStatus.phase, 
        status: currentStatus.status 
      });
      
      // Use API endpoint for automatic GitHub integration
      const response = await fetch(API_STATUS_UPDATE, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          progress: currentStatus.progress,
          phase: currentStatus.phase,
          status: currentStatus.status,
          phaseName: currentStatus.phaseName,
          eta: currentStatus.eta,
          scope: currentStatus.scope,
          owner: currentStatus.owner,
          client: currentStatus.client
        })
      });

      console.log('Response status:', response.status);
      
      if (!response.ok) {
        const errorText = await response.text();
        console.error('API Error Response:', errorText);
        
        let errorMessage = 'Deployment failed';
        try {
          const errorJson = JSON.parse(errorText);
          errorMessage = errorJson.error || errorMessage;
        } catch (e) {
          errorMessage = `HTTP ${response.status}: ${errorText.substring(0, 100)}`;
        }
        
        alert('‚ùå ' + errorMessage);
        return;
      }

      const result = await response.json();
      console.log('API Success Response:', result);
      
      if (result.success) {
        alert('üöÄ Status update deployed successfully! Changes automatically pushed to GitHub. Zebediah will see the changes immediately.');
      } else {
        alert('‚ùå Deployment failed: ' + (result.error || 'Unknown error'));
      }
    } catch (error) {
      console.error('Deployment error:', error);
      alert('‚ùå Deployment error: ' + error.message);
    }
  }

  async function deployPhaseChange() {
    try {
      console.log('Deploying phase change:', currentStatus);
      
      const status = `Phase transition to ${currentStatus.phase} - ${currentStatus.progress}% complete`;
      
      const response = await fetch(API_STATUS_UPDATE, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          progress: currentStatus.progress,
          phase: currentStatus.phase,
          status,
          phaseName: currentStatus.phaseName,
          eta: currentStatus.eta,
          scope: currentStatus.scope,
          owner: currentStatus.owner,
          client: currentStatus.client
        })
      });

      if (!response.ok) {
        const errorText = await response.text();
        console.error('API Error Response:', errorText);
        
        let errorMessage = 'Phase change deployment failed';
        try {
          const errorJson = JSON.parse(errorText);
          errorMessage = errorJson.error || errorMessage;
        } catch (e) {
          errorMessage = `HTTP ${response.status}: ${errorText.substring(0, 100)}`;
        }
        
        alert('‚ùå ' + errorMessage);
        return;
      }

      const result = await response.json();
      console.log('API Success Response:', result);
      
      if (result.success) {
        alert('üîÑ Phase change deployed successfully! Changes automatically pushed to GitHub.');
      } else {
        alert('‚ùå Phase change failed: ' + (result.error || 'Unknown error'));
      }
    } catch (error) {
      console.error('Phase change error:', error);
      alert('‚ùå Phase change error: ' + error.message);
    }
  }

  // Manual Sync Function - Prefer JSON read; optionally ping API
  async function syncWithStatusPage() {
    try {
      console.log('üîÑ Syncing from JSON...');
      const response = await fetch('inex-live-data.json');
      if (response.ok) {
        const liveData = await response.json();
        
        // Update local status to match live data
        currentStatus.progress = liveData.progress || currentStatus.progress;
        currentStatus.phase = liveData.phase || currentStatus.phase;
        currentStatus.status = liveData.status || currentStatus.status;
        currentStatus.lastUpdated = liveData.lastUpdated || currentStatus.lastUpdated;
        
        updateAllStatusDisplays();
        alert('‚úÖ Status synchronized from JSON!');
      } else {
        alert('‚ö†Ô∏è Could not load live status data');
      }
    } catch (error) {
      console.error('Sync error:', error);
      alert('‚ùå Sync failed: ' + error.message);
    }
  }

  // Messaging System Functions - Use API endpoints
  async function loadDevMessages() {
    const messagesList = document.getElementById('messagesList');
    if (!messagesList) {
      console.log('üì® messagesList element not found, skipping message load');
      return;
    }
    
    try {
      // Always try API first for both dev and live
      console.log('üì° Loading messages from API endpoint:', API_MESSAGES);
      const response = await fetch(API_MESSAGES, { 
        cache: 'no-store',
        headers: { 'Content-Type': 'application/json' }
      });
      
      if (response.ok) {
        const data = await response.json();
        const messages = data.messages || [];
        displayDevMessages(messages);
        console.log(`‚úÖ Loaded ${messages.length} messages from API`);
        return;
      } else {
        console.log('‚ö†Ô∏è API request failed, falling back to JSON file');
      }
      
      // Fallback to JSON file if API fails
      console.log('üìÑ Trying fallback JSON file...');
      const jsonResponse = await fetch('inex-live-data.json', { cache: 'no-store' });
      if (jsonResponse.ok) {
        const liveData = await jsonResponse.json();
        const messages = liveData.messages || [];
        displayDevMessages(messages);
        console.log(`‚úÖ Loaded ${messages.length} messages from fallback JSON file`);
        return;
      }
      
      // Final fallback to localStorage
      console.log('üíæ Trying localStorage fallback...');
      const savedMessages = localStorage.getItem('inex-messages');
      if (savedMessages) {
        try {
          const messages = JSON.parse(savedMessages);
          if (messages.length > 0) {
            displayDevMessages(messages);
            console.log(`‚úÖ Loaded ${messages.length} messages from localStorage fallback`);
            return;
          }
        } catch (e) {
          console.warn('Failed to parse localStorage messages in fallback:', e.message);
        }
      }
      
      // Show no messages if all sources fail
      console.log('All sources failed, showing empty state');
      displayDevMessages([]);
      
    } catch (error) {
      console.warn('Failed to load messages from consolidated JSON:', error.message);
      displayDevMessages([]);
    }
  }

  // Enhanced function to load messages from JSON file directly (for immediate display)
  async function loadMessagesFromJSON() {
    try {
      console.log('üìÑ Loading messages directly from JSON file...');
      const response = await fetch('inex-live-data.json', { cache: 'no-store' });
      if (response.ok) {
        const liveData = await response.json();
        const messages = liveData.messages || [];
        console.log(`‚úÖ Loaded ${messages.length} messages directly from JSON`);
        return messages;
      }
    } catch (error) {
      console.warn('Failed to load messages from JSON:', error.message);
    }
    return [];
  }

  function displayDevMessages(messages) {
    console.log('üé® displayDevMessages called with:', messages);
    const messagesList = document.getElementById('messagesList');
    if (!messagesList) {
      console.warn('‚ùå messagesList element not found!');
      return;
    }
    
    console.log('‚úÖ messagesList element found, updating with', messages.length, 'messages');
    
    if (messages.length === 0) {
      messagesList.innerHTML = `
        <div class="message-item" style="text-align:center">
          <div style="font-size:24px;margin-bottom:8px">üí¨</div>
          <div style="font-weight:600;margin-bottom:4px">No messages yet</div>
          <div class="muted">Send the first message to get started!</div>
        </div>
      `;
      return;
    }

    // Class-based markup so CSS controls the visuals consistently
    messagesList.innerHTML = messages.map(msg => {
      const priority = (msg.priority || 'normal').toLowerCase();
      const priorityBarClass = priority === 'urgent' ? 'urgent' : priority === 'high' ? 'high' : priority === 'low' ? 'low' : '';
      const priorityTagClass = priority === 'urgent' ? 'priority-urgent' : priority === 'high' ? 'priority-high' : priority === 'low' ? 'priority-low' : '';
      return `
        <div class="message-item">
          ${priority !== 'normal' ? `<div class="priority-bar ${priorityBarClass}"></div>` : ''}
          <div class="message-header">
            <div class="left">
              <div class="message-avatar">${(msg.name || 'A').charAt(0).toUpperCase()}</div>
              <div>
                <strong style="font-size:16px;display:block">${msg.name || 'Anonymous'}</strong>
                ${msg.email ? `<small class="muted" style="font-size:12px">${msg.email}</small>` : ''}
              </div>
            </div>
            <div class="right" style="display:flex;align-items:center;gap:8px">
              ${priority !== 'normal' ? `<span class="priority-tag ${priorityTagClass}">${priority}</span>` : ''}
              <small class="message-time">${formatTimestamp(msg.timestamp)}</small>
            </div>
          </div>
          <div class="message-content">${msg.text}</div>
          ${msg.responses && msg.responses.length > 0 ? `
            <div class="message-response">
              <div class="label">Response</div>
              <div class="text">${msg.responses[msg.responses.length - 1].text}</div>
              <div class="meta"><span>üë§</span><span>${msg.responses[msg.responses.length - 1].responder || 'Development Team'}</span><span>‚Ä¢</span><span>${formatTimestamp(msg.responses[msg.responses.length - 1].timestamp)}</span></div>
            </div>
          ` : ''}
          <div class="message-actions" style="display:flex;gap:8px;margin-top:16px;padding-top:16px;border-top:1px solid var(--border);justify-content:space-between;align-items:center">
            <div class="message-status">
              <span class="status-chip"><span class="status-dot ${msg.read ? 'ok' : 'warn'}"></span>${msg.read ? 'Read' : 'Unread'}</span>
              <span class="status-chip"><span class="status-dot ${msg.responded ? 'ok' : 'err'}"></span>${msg.responded ? 'Responded' : 'No Response'}</span>
            </div>
            <div class="action-buttons" style="display:flex;gap:8px">
              ${!msg.read ? `<button class="btn secondary" style="padding:6px 12px;font-size:12px" onclick="markMessageAsRead('${msg.id}')">‚úì Mark Read</button>` : ''}
              ${!msg.responded ? `<button class="btn primary" style="padding:6px 12px;font-size:12px" onclick="showReplyForm('${msg.id}', '${msg.name}')">üí¨ Reply</button>` : ''}
            </div>
          </div>
        </div>
      `;
    }).join('');
  }



  function refreshMessages() {
    console.log('üîÑ Refreshing messages...');
    loadDevMessages();
  }

  function markMessageRead() {
    // This could be expanded to mark specific messages as read
    alert('Messages marked as read!');
  }

  function clearMessages() {
    if (confirm('Are you sure you want to clear all messages? This will only clear the display - messages remain in the JSON file.')) {
      displayDevMessages([]);
      alert('Message display cleared! Messages remain in the JSON file.');
    }
  }

  // Add response to a message
  async function addResponse(messageId) {
    const responseText = prompt('Enter your response to this message:');
    if (!responseText || !responseText.trim()) return;
    
    try {
      // Try to update via API first
              const response = await fetch(API_MESSAGES, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            messageId: messageId,
            response: responseText.trim()
          })
        });
      
      if (response.ok) {
        // Reload messages to show the response
        await loadDevMessages();
        alert('‚úÖ Response added successfully!');
      } else {
        throw new Error('API request failed');
      }
    } catch (error) {
      console.warn('API failed:', error.message);
      alert('‚ùå Could not add response. Please try again later.');
    }
  }

  // Show reply form for a specific message
  function showReplyForm(messageId, recipientName) {
    document.getElementById('replyFormContainer').style.display = 'block';
    document.getElementById('replyToName').textContent = recipientName;
    document.getElementById('replyText').value = '';
    document.getElementById('replyCharCount').textContent = '0 characters';
    
    // Store the message ID for the reply
    window.currentReplyMessageId = messageId;
    
    // Focus on the reply textarea
    document.getElementById('replyText').focus();
    
    // Add character count functionality
    const replyText = document.getElementById('replyText');
    const replyCharCount = document.getElementById('replyCharCount');
    
    replyText.addEventListener('input', function() {
      const textLength = this.value.length;
      replyCharCount.textContent = `${textLength} characters`;
    });
  }

  // Hide reply form
  function hideReplyForm() {
    document.getElementById('replyFormContainer').style.display = 'none';
    window.currentReplyMessageId = null;
  }

  // Submit reply to a message
  async function submitReply() {
    const messageId = window.currentReplyMessageId;
    const responseText = document.getElementById('replyText').value.trim();
    
    if (!responseText) {
      alert('Please enter a response');
      return;
    }
    
    if (!messageId) {
      alert('No message selected for reply');
      return;
    }
    
    try {
      // Show loading state
      const submitBtn = document.querySelector('#replyFormContainer button[onclick="submitReply()"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'üì§ Sending...';
      submitBtn.disabled = true;
      
      // Send reply via API
      const response = await fetch(API_MESSAGES, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          id: messageId,
          action: 'addResponse',
          responseText: responseText,
          responder: 'Development Team'
        })
      });
      
      if (response.ok) {
        // Hide reply form
        hideReplyForm();
        
        // Reload messages to show the response
        await loadDevMessages();
        
        // Show success message
        alert('‚úÖ Response sent successfully!');
      } else {
        throw new Error('API request failed');
      }
    } catch (error) {
      console.warn('API failed:', error.message);
      alert('‚ùå Could not send response. Please try again later.');
    } finally {
      // Reset button state
      const submitBtn = document.querySelector('#replyFormContainer button[onclick="submitReply()"]');
      submitBtn.innerHTML = 'üì§ Send Response';
      submitBtn.disabled = false;
    }
  }

  // Mark message as read
      async function markMessageAsRead(messageId) {
      try {
        const response = await fetch(API_MESSAGES, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            messageId: messageId,
            action: 'markRead'
          })
        });
      
      if (response.ok) {
        // Reload messages to show updated status
        await loadDevMessages();
        console.log('‚úÖ Message marked as read');
      } else {
        throw new Error('API request failed');
      }
    } catch (error) {
      console.warn('API failed:', error.message);
      alert('‚ùå Could not mark message as read. Please try again later.');
    }
  }

  // Load messages when page loads
  window.addEventListener('load', function() {
    // Wait a bit for the DOM to be fully ready
    setTimeout(() => {
      loadDevMessages();
    }, 500);
  });

  // Function to update dashboard progress display
  function updateDashboardProgress() {
    updateAllStatusDisplays();
  }

  // Message Form Functionality - Will be initialized after view rendering
  let messageFormInitialized = false;

  function initializeMessageForm() {
    if (messageFormInitialized) return;
    
    const messageForm = document.getElementById('messageForm');
    const messageText = document.getElementById('messageText');
    const charCount = document.getElementById('charCount');
    
    if (!messageForm || !messageText || !charCount) {
      console.log('‚è≥ Message form elements not ready yet, will retry in 100ms...');
      console.log('üîç Current DOM state:', {
        messageForm: document.getElementById('messageForm'),
        messageText: document.getElementById('messageText'),
        charCount: document.getElementById('charCount'),
        allForms: document.querySelectorAll('form').length,
        allInputs: document.querySelectorAll('input').length,
        allTextareas: document.querySelectorAll('textarea').length
      });
      setTimeout(initializeMessageForm, 100);
      return;
    }
    
    console.log('üîç Message form elements found:', {
      messageForm: !!messageForm,
      messageText: !!messageText,
      charCount: !!charCount
    });

    // Update character count
    messageText.addEventListener('input', function() {
      const textLength = this.value.length;
      charCount.textContent = `${textLength} characters`;
    });

    // Handle message form submission
    console.log('‚úÖ Message form found and event listener attached');
    messageForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      console.log('üìù Form submitted! Processing message...');
      
      const nameInput = document.getElementById('messageName');
      const textInput = document.getElementById('messageText');
      
      const name = nameInput.value.trim() || 'Anonymous';
      const text = textInput.value.trim();
      
      console.log('üìù Message details:', { name, text, isLiveSite, isDev });
      
      if (!text) {
        alert('Please enter a message');
        return;
      }

      // Show loading state
      const submitBtn = messageForm.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'üì§ Sending...';
      submitBtn.disabled = true;

      try {
        if (isLiveSite) {
          console.log('üåê Live site detected, attempting API call first, then fallback to local');
          
          try {
            // Try API call first for live site GitHub integration
            console.log('üöÄ Attempting API call for live site GitHub integration');
            const response = await fetch(API_MESSAGES, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                name: name,
                text: text,
                priority: 'normal',
                category: 'client-feedback'
              })
            });

            if (response.ok) {
              // API success - message added directly to JSON file
              const result = await response.json();
              console.log('‚úÖ Message sent successfully via API on live site:', result);
              
              // Display the new message immediately using the returned data
              if (result.allMessages) {
                displayDevMessages(result.allMessages);
              } else {
                // Fallback: reload messages
                await loadDevMessages();
              }
              
              // Show success message
              showMessageSuccess('Message sent successfully! It has been saved and will appear on this page immediately.');
              
              // Reset form
              textInput.value = '';
              charCount.textContent = '0 characters';
              return; // Exit early on success
            } else {
              console.log('‚ö†Ô∏è API call failed on live site, falling back to local storage');
            }
          } catch (error) {
            console.log('‚ö†Ô∏è API call error on live site, falling back to local storage:', error.message);
          }
          
          // Fallback to local storage if API fails
          console.log('üíæ Falling back to localStorage for live site');
          const message = {
            name: name,
            text: text,
            timestamp: new Date().toISOString(),
            id: Date.now(),
            priority: 'normal',
            category: 'client-feedback',
            status: 'new',
            read: false,
            responded: false
          };

          console.log('üíæ Saving message to localStorage:', message);

          // Save to localStorage for immediate display
          const savedMessages = localStorage.getItem('inex-messages') || '[]';
          const messages = JSON.parse(savedMessages);
          messages.unshift(message);
          localStorage.setItem('inex-messages', JSON.stringify(messages));
          
          console.log('‚úÖ Message saved to localStorage, now displaying...');
          
          // Display the new message immediately
          displayDevMessages(messages);
          
          // Show success message
          showMessageSuccess('Message saved locally (API unavailable). Messages will be synced when the API is available.');
          
          // Reset form
          textInput.value = '';
          charCount.textContent = '0 characters';
          
        } else {
          // For development, try the API endpoint first for automatic GitHub push
          console.log('Sending message via API for automatic GitHub push');
          const response = await fetch(API_MESSAGES, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              name: name,
              text: text,
              priority: 'normal',
              category: 'client-feedback'
            })
          });

          if (response.ok) {
            // API success - message added directly to JSON file
            const result = await response.json();
            console.log('‚úÖ Message sent successfully via API:', result);
            
            // Display the new message immediately using the returned data
            if (result.allMessages) {
              displayDevMessages(result.allMessages);
            } else {
              // Fallback: reload messages
              await loadDevMessages();
            }
            
            // Show success message
            showMessageSuccess('Message sent successfully! It has been saved and will appear on this page immediately.');
            
            // Reset form
            textInput.value = '';
            charCount.textContent = '0 characters';
            
          } else {
            // API failed - try to get error details
            let errorMessage = 'Failed to send message';
            try {
              const errorData = await response.json();
              errorMessage = errorData.error || errorMessage;
            } catch (e) {
              // Ignore JSON parse errors
            }
            
            throw new Error(`API Error: ${errorMessage}`);
          }
        }
        
      } catch (error) {
        console.error('Failed to send message via API:', error.message);
        
        // Show error message
        showMessageSuccess('Message could not be sent. Please check your connection and try again.');
      }

      // Reset button
      submitBtn.innerHTML = originalText;
      submitBtn.disabled = false;
    });
    
    messageFormInitialized = true;
    console.log('‚úÖ Message form initialization complete');
  }

  // Format timestamp for messages
  function formatTimestamp(timestamp) {
    if (!timestamp) return 'Unknown time';
    try {
      const date = new Date(timestamp);
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMs / 3600000);
      const diffDays = Math.floor(diffMs / 86400000);
      
      if (diffMins < 1) return 'Just now';
      if (diffMins < 60) return `${diffMins}m ago`;
      if (diffHours < 24) return `${diffHours}h ago`;
      if (diffDays < 7) return `${diffDays}d ago`;
      
      return date.toLocaleDateString();
    } catch (e) {
      return 'Unknown time';
    }
  }

  // Show success message
  function showMessageSuccess(message) {
    // Create notification element
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 80px;
      right: 20px;
      background: var(--maroon);
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      max-width: 300px;
      animation: slideIn 0.3s ease-out;
    `;
    
    notification.innerHTML = `
      <div style="font-weight: 700; margin-bottom: 4px;">‚úÖ Success!</div>
      <div style="font-size: 13px; opacity: 0.9;">${message}</div>
      <button onclick="this.parentElement.remove()" style="position: absolute; top: 8px; right: 8px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">√ó</button>
    `;
    
    // Add CSS animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
    `;
    document.head.appendChild(style);
    
    document.body.appendChild(notification);
    
    // Auto-remove after 8 seconds
    setTimeout(() => {
      if (notification.parentElement) {
        notification.remove();
      }
    }, 8000);
  }

  // Manual message sync function for live sites
  async function syncMessagesToGitHub() {
    try {
      console.log('üöÄ Attempting to sync local messages...');
      
      // Get local messages
      const savedMessages = localStorage.getItem('inex-messages');
      if (!savedMessages) {
        alert('No local messages to sync');
        return;
      }
      
      const messages = JSON.parse(savedMessages);
      if (messages.length === 0) {
        alert('No messages to sync');
        return;
      }
      
      console.log(`üì§ Syncing ${messages.length} messages...`);
      
      // Try to sync via API
      const response = await fetch(API_MESSAGES, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'sync',
          messages: messages
        })
      });
      
      if (response.ok) {
        const result = await response.json();
        console.log('‚úÖ Messages synced successfully:', result);
        alert(`‚úÖ Successfully synced ${messages.length} messages!`);
        
        // Display updated messages immediately
        if (result.messages) {
          displayDevMessages(result.messages);
        } else {
          // Fallback: reload messages
          await loadDevMessages();
        }
      } else {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
    } catch (error) {
      console.error('‚ùå Failed to sync messages:', error);
      alert(`‚ùå Failed to sync messages: ${error.message}\n\nThis usually means the API server is not running. Messages are still saved locally.`);
    }
  }

  // Note: loadDevMessages is now called only when the status view is rendered
  // This prevents errors when other views don't have the message elements

  // INEX Unified Authentication System Integration
  // The auth-system.js handles all Firebase authentication automatically
  
  // Update authentication UI based on user state
  function updateAuthUI() {
    const authBanner = document.getElementById('authBanner');
    const userInfo = document.getElementById('userInfo');
    const messageForm = document.getElementById('messageForm');
    const userInfoContent = document.getElementById('userInfoContent');
    const signOutBtn = document.getElementById('signOutBtn');

    if (window.inexAuth && window.inexAuth.isAuthenticated()) {
      const user = window.inexAuth.getCurrentUser();
      // User is signed in
      if (authBanner) authBanner.style.display = 'none';
      if (userInfo) {
        userInfo.style.display = 'block';
        if (userInfoContent) {
          userInfoContent.innerHTML = `
            <strong>üë§ Signed in as: ${user.email}</strong><br>
            <small>Your messages will be automatically attributed to your account.</small>
          `;
        }
      }
      if (signOutBtn) signOutBtn.style.display = 'inline-block';
      if (messageForm) messageForm.style.display = 'grid';
      
      // Auto-populate name field with user's display name or email
      const nameInput = document.getElementById('messageName');
      if (nameInput) {
        nameInput.value = user.displayName || user.email.split('@')[0] || '';
      }
    } else {
      // User is signed out
      if (authBanner) authBanner.style.display = 'block';
      if (userInfo) userInfo.style.display = 'none';
      if (signOutBtn) signOutBtn.style.display = 'none';
      if (messageForm) messageForm.style.display = 'grid';
    }
  }

  // Handle sign in using the unified system
  async function handleSignIn() {
    try {
      const email = document.getElementById('authEmail').value.trim();
      const password = document.getElementById('authPassword').value;
      const status = document.getElementById('authStatus');
      
      if (!email || !password) {
        status.textContent = 'Please enter both email and password';
        return;
      }
      
      status.textContent = 'Signing in...';
      await window.inexAuth.signIn(email, password);
      status.textContent = 'Sign in successful!';
      
      // Clear form
      document.getElementById('authEmail').value = '';
      document.getElementById('authPassword').value = '';
      
    } catch (error) {
      console.error('Sign in error:', error);
      status.textContent = 'Sign in failed: ' + error.message;
    }
  }

  // Handle sign up using the unified system
  async function handleSignUp() {
    try {
      const email = document.getElementById('authEmail').value.trim();
      const password = document.getElementById('authPassword').value;
      const status = document.getElementById('authStatus');
      
      if (!email || !password) {
        status.textContent = 'Please enter both email and password';
        return;
      }
      
      if (password.length < 6) {
        status.textContent = 'Password must be at least 6 characters';
        return;
      }
      
      status.textContent = 'Creating account...';
      await window.inexAuth.signUp(email, password);
      status.textContent = 'Account created successfully!';
      
      // Clear form
      document.getElementById('authEmail').value = '';
      document.getElementById('authPassword').value = '';
      
    } catch (error) {
      console.error('Sign up failed:', error);
      status.textContent = 'Sign up failed: ' + error.message;
    }
  }

  // Handle sign out using the unified system
  async function handleSignOut() {
    try {
      console.log('Sign out button clicked in index.html');
      await window.inexAuth.signOut();
      console.log('User signed out successfully from index.html');
    } catch (error) {
      console.error('Sign out error:', error);
    }
  }

  // Initialize when page loads
  window.addEventListener('load', function() {
    // Wait for the unified auth system to be ready
    const waitForAuth = () => {
      if (window.inexAuth && window.inexAuth.isInitialized) {
        // Add auth state listener to update UI
        window.inexAuth.addAuthStateListener(updateAuthUI);
        
        // Add event listeners for auth buttons
        const authLoginBtn = document.getElementById('authLoginBtn');
        const authSignupBtn = document.getElementById('authSignupBtn');
        const signOutBtn = document.getElementById('signOutBtn');
        
        if (authLoginBtn) {
          authLoginBtn.addEventListener('click', handleSignIn);
        }
        
        if (authSignupBtn) {
          authSignupBtn.addEventListener('click', handleSignUp);
        }
        
        if (signOutBtn) {
          signOutBtn.addEventListener('click', handleSignOut);
        }
        
        // Add enter key support for auth form
        const authEmail = document.getElementById('authEmail');
        const authPassword = document.getElementById('authPassword');
        
        if (authEmail && authPassword) {
          authEmail.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              authPassword.focus();
            }
          });
          
          authPassword.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              handleSignIn();
            }
          });
        }
        
        // Initialize other components
        initializeThemeToggle();
        initializeMessageForm();
        loadMessages();
        loadDevMessages();
        
        console.log('‚úÖ INEX Dashboard initialized with unified auth system');
      } else {
        setTimeout(waitForAuth, 100);
      }
    };
    
    waitForAuth();
  });
</script>
</body>
</html>